# NadVibS
NadVibS is a nonadiabatic vibrational spectrum simulation package.
It originates from NADVIBS.X by former [Yarkony Group](https://github.com/yarkonygrp/) member [Michael Schuurman](https://github.com/mschuurman) in 2007, who is now leading [Schuurman Group](https://github.com/schuurman-group).

Tasks:
* Diagonalize diabatic vibronic Hamiltonian
* Determine Franck-Condon overlap
* Generate input file for BROOKLYN to calculate spin-orbit fine structure

## Python utilities

extract.py:
* Extract spectral data from NadVibS output
* Required argument: input

convolve.py:
* Performs convolution
* Required arguments: start, stop, input (generated by extract.py), aperture, sigma

modify.py:
* Renormalize, rescale, invert, shift the spectrum
* Throw out the lines with 0 intensity
* Required argument: input (generated by extract.py or convolve.py)

plot.py:
* Plot the simulated line spectrum
* Plot continuous spectrum

## Usage
Python scripts are simple: use -h argument to show help message

To run NadVibS, use command: mpirun -hostfile hostfile -np `#CPU` `NadVibSDirectory`/NadVibS.exe -m `MemoryInMB` -o `OutputDirectory` > log

NadVibS requires 2 input files: nadvibs.in and basis.in (as well as restart.log if not restart = 0), an example is provided. nadvibs.in will be automatically generated by [SurfgenBound 2](https://github.com/cavanes1/SurfgenBound2), which is the updated version of [SurfGenBound](https://github.com/YifanShenSZ/SurfGenBound). However, the user has to take care of the FORTRAN namelist file basis.in:

| Keyword  | Default | Meaning |
| ------------- | ------------- | ------------- |
| restart   | | 0, new job; else, restart |
| niter     | | number of lanczos iterations to be performed |
| basis     | | number of basis functions for each vibrational mode |
| initstate | | the initial vibrational state of the precursor (specified by the quanta of each precursor normal mode) |
| nstates   | | number of electronic states |
| ordr      | | order of the expansion for diabatic hamiltonian |
| natoms    | | number of atoms in molecule |
| nmodes    | | number of vibrational modes |
| nirreps   | | number of irreducible representations in point group symmetry |
| npirr     | | number of normal modes in each irreducible representation |
| shiftref  | | 0, do not use new origin; else, use new origin |
| bconv     | 0 | -lg( convergence tolerence for eigen value ) |
| idroots   | 0 | how many of the lead contributors to a vibronic level to identify |
| soroots   | 0 | number of roots to compute spin orbit parameters |
| reorthog  | 0 | >0, request re-orthogonalization; >1, exact dot products are to be used to monitor lanczos vector orthogonality  |
| chkorthog | 100 | every how many iterations compute exact dot products if using recurrence |
| nseg      | 1 | number of segements to divide lanczos vector into |
| ztoler    | 1d-20 | Any coefficient less ztoler is set to 0 |
| maxdisk   | 1000 | maximum amount of disk available for use (in MB) |
| weights   | 1 | initial weights of the electronic states |

## Dependency
Global Arrays 5.4 or later

## References
> 1. M. S. Schuurman, R. A. Young, D. R. Yarkony 2007 Chem. Phys.
> 2. M. S. Schuurman, D. Yarkony 2008 J. Chem. Phys.
